<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="de"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Run your own Apache Spark jobs in AWS EMR and S3" /><meta property="og:locale" content="en" /><meta name="description" content="Run your own Apache Spark jobs in AWS EMR and S3" /><meta property="og:description" content="Run your own Apache Spark jobs in AWS EMR and S3" /><link rel="canonical" href="https://samueltyh.github.io/posts/run-your-own-apache-spark-jobs-in-aws-emr-and-s3/" /><meta property="og:url" content="https://samueltyh.github.io/posts/run-your-own-apache-spark-jobs-in-aws-emr-and-s3/" /><meta property="og:site_name" content="samueltyh" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-01T01:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Run your own Apache Spark jobs in AWS EMR and S3" /><meta name="twitter:site" content="@samueltyh" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-06T23:48:28+02:00","datePublished":"2021-02-01T01:00:00+01:00","description":"Run your own Apache Spark jobs in AWS EMR and S3","headline":"Run your own Apache Spark jobs in AWS EMR and S3","mainEntityOfPage":{"@type":"WebPage","@id":"https://samueltyh.github.io/posts/run-your-own-apache-spark-jobs-in-aws-emr-and-s3/"},"url":"https://samueltyh.github.io/posts/run-your-own-apache-spark-jobs-in-aws-emr-and-s3/"}</script><title>Run your own Apache Spark jobs in AWS EMR and S3 | samueltyh</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="samueltyh"><meta name="application-name" content="samueltyh"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/AvatarMaker.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">samueltyh</a></div><div class="site-subtitle font-italic">DevOps, Data Engineering, Data Science</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/samueltyh" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/samueltyh" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['samueltseng','icloud.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Run your own Apache Spark jobs in AWS EMR and S3</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Run your own Apache Spark jobs in AWS EMR and S3</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1612137600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 1, 2021 </em> </span> <span> Updated <em class="" data-ts="1659822508" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 6, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/samueltyh">Samuel Tseng</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="670 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h2 id="run-your-own-apache-spark-jobs-in-aws-emr-and-s3"><span class="mr-2">Run your own Apache Spark jobs in AWS EMR and S3</span><a href="#run-your-own-apache-spark-jobs-in-aws-emr-and-s3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Recently, I participated in Udacity’s Nanodegree Program for Data Engineers. It’s kinda like to review what I did past and refresh some tech stacks’ knowledge for me in the Data Engineering field. Today, I’m gonna writing this article to avoid you spending extra efforts to run a Spark job or other Hadoop eco-systems jobs on AWS.</p><p>This idea comes from the Data Lake demo below, you can find the part I tried to apply through Shell script and Makefile between [S3-&gt;EMR-&gt;S3] in the figure. The PySpark script I used reference from the project in Course Data Lake, click the photo to check detail.</p><p><a href="https://s3.eu-central-1.amazonaws.com/samueltyh.github.io/posts/datalake_demo.png"><img data-src="https://s3.eu-central-1.amazonaws.com/samueltyh.github.io/posts/datalake_demo.png" alt="" class="img-responsive" data-proofer-ignore></a></p><p>Before we start, make sure you’ve already done with registering an AWS account and downloading the credential on <a href="https://aws.amazon.com/">AWS console</a>(the easiest way, you bet).</p><h3 id="emr-workflow"><span class="mr-2">EMR workflow</span><a href="#emr-workflow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First off, let us have a look at the EMR workflow, click the photo to check detail.</p><p><a href="https://s3.eu-central-1.amazonaws.com/samueltyh.github.io/posts/emr-workflow.png"><img data-src="https://s3.eu-central-1.amazonaws.com/samueltyh.github.io/posts/emr-workflow.png" alt="" class="img-responsive" data-proofer-ignore></a></p><p>What we want to do, is to make sure the work of setting up and launching a cluster, adding working steps, creating log files, and terminating the cluster as simple as we can. AWS CLI(command-line interface) builds an easy interface and functional usage for operating various services on AWS. But we are eager to make entire management much simpler and flexible to check the status, even put it aside until the job is finished.</p><p>Of course, you have other choices like SDK for different languages, like <a href="https://docs.aws.amazon.com/pythonsdk/?id=docs_gateway">Python SDK</a> or <a href="https://docs.aws.amazon.com/sdk-for-java/?id=docs_gateway">Java SDK</a> if you like. In my experiences, every SDK sometimes use a different version of libraries or packages, you should be aware of the supporting version on each service you choose.</p><h3 id="idea-and-practice"><span class="mr-2">Idea and Practice</span><a href="#idea-and-practice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We can choose the easy-checking cli command for pipeline, such as creating-cluster, add-steps, and terminate-clusters. The cli command from document is shown below.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>aws emr create-cluster <span class="se">\</span>
<span class="nt">--name</span> <span class="s2">"My First EMR Cluster"</span> <span class="se">\</span>
<span class="nt">--release-label</span> emr-5.31.0 <span class="se">\</span>
<span class="nt">--applications</span> <span class="nv">Name</span><span class="o">=</span>Spark <span class="se">\</span>
<span class="nt">--ec2-attributes</span> <span class="nv">KeyName</span><span class="o">=</span>myEMRKeyPairName <span class="se">\</span>
<span class="nt">--instance-type</span> m5.xlarge <span class="se">\</span>
<span class="nt">--instance-count</span> 3 <span class="se">\</span>
<span class="nt">--use-default-roles</span>
</pre></table></code></div></div><p>Set the command as a variable to load in the next step, add 2 additional arguments <code class="language-plaintext highlighter-rouge">--query '[ClusterId]'</code>, <code class="language-plaintext highlighter-rouge">--output text</code> to change the output format and query the information we need, reference the variable <code class="language-plaintext highlighter-rouge">cluster_id</code> in the Shell scripts as below.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nv">cluster_id</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>aws emr create-cluster <span class="nt">--name</span> SparkifyEMR <span class="se">\</span>
<span class="nt">--release-label</span> emr-5.31.0 <span class="se">\</span>
<span class="nt">--log-uri</span> <span class="s2">"s3://</span><span class="nv">$clustername</span><span class="s2">/logs/"</span> <span class="se">\</span>
<span class="nt">--applications</span> <span class="nv">Name</span><span class="o">=</span>Spark <span class="se">\</span>
<span class="nt">--ec2-attributes</span> <span class="nv">KeyName</span><span class="o">=</span><span class="s2">"</span><span class="nv">$keyname</span><span class="s2">"</span> <span class="se">\</span>
<span class="nt">--instance-type</span> m5.xlarge <span class="se">\</span>
<span class="nt">--instance-count</span> 3 <span class="se">\</span>
<span class="nt">--use-default-roles</span> <span class="se">\</span>
<span class="nt">--query</span> <span class="s1">'[ClusterId]'</span> <span class="se">\</span>
<span class="nt">--output</span> text<span class="si">)</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">ClusterId: </span><span class="nv">$cluster_id</span><span class="s2">"</span>
</pre></table></code></div></div><p>Set the second variable <code class="language-plaintext highlighter-rouge">step_id</code> and query it.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">step_id</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>aws emr add-steps <span class="se">\</span>
<span class="nt">--cluster-id</span> <span class="s2">"</span><span class="nv">$cluster_id</span><span class="s2">"</span> <span class="se">\</span>
<span class="nt">--steps</span> <span class="s2">"Type=Spark,Name=SparkifyETL,ActionOnFailure=CONTINUE,</span><span class="se">\</span><span class="s2">
Args=[s3://</span><span class="nv">$clustername</span><span class="s2">/run_etl.py,--data_source,</span><span class="nv">$clustername</span><span class="s2">/data/,--output_uri,</span><span class="nv">$clustername</span><span class="s2">/output/]"</span> <span class="se">\</span>
<span class="nt">--query</span> <span class="s1">'StepIds[0]'</span> <span class="se">\</span>
<span class="nt">--output</span> text<span class="si">)</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">StepId: </span><span class="nv">$step_id</span><span class="s2">"</span>
</pre></table></code></div></div><p>Set a while loop to check Spark jobs is finished or not.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nv">describe_step</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>aws emr describe-step <span class="nt">--cluster-id</span> <span class="s2">"</span><span class="nv">$cluster_id</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--step-id</span> <span class="s2">"</span><span class="nv">$step_id</span><span class="s2">"</span> <span class="nt">--query</span> <span class="s1">'Step.Status.State'</span> <span class="nt">--output</span> text<span class="si">)</span><span class="s2">"</span>

<span class="k">while </span><span class="nb">true</span><span class="p">;</span> <span class="k">do
  if</span> <span class="o">[[</span> <span class="nv">$describe_step</span> <span class="o">=</span> <span class="s1">'PENDING'</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Cluster creating... Autocheck state 2 mins later"</span>
    <span class="nb">sleep </span>120
  <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$describe_step</span> <span class="o">=</span> <span class="s1">'RUNNING'</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Job running... Autocheck state 30 seconds later"</span>
    <span class="nb">sleep </span>30
  <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$describe_step</span> <span class="o">=</span> <span class="s1">'FAILED'</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Job failed"</span>
    <span class="nb">break
  </span><span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"Job completed"</span>
    <span class="nb">break
  </span><span class="k">fi
done</span>
</pre></table></code></div></div><p>After finishing all jobs, terminate the cluster of the jobs complete without error.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nv">terminate_cluster</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>aws emr terminate-clusters <span class="se">\</span>
<span class="nt">--cluster-ids</span> <span class="s2">"</span><span class="nv">$cluster_id</span><span class="s2">"</span> <span class="se">\</span>
<span class="nt">--query</span> <span class="s1">'Cluster.Status.State'</span> <span class="se">\</span>
<span class="nt">--output</span> text<span class="si">)</span><span class="s2">"</span>

<span class="k">while </span><span class="nb">true</span><span class="p">;</span> <span class="k">do
  if</span> <span class="o">[[</span> <span class="nv">$terminate_cluster</span> <span class="o">!=</span> <span class="s1">'TERMINATED'</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Cluster terminating..."</span>
    <span class="nb">sleep </span>15
  <span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"Cluster terminated"</span>
  <span class="k">fi
done</span>
</pre></table></code></div></div><h3 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Anyway, this script brings you a convenient approach to run one-time Spark jobs in AWS EMR Cluster. You can also check the all lines in the script <a href="https://gist.github.com/samuelTyh/04fb77ae0b81154d2a5b61b17d2635f8">here</a> for reference.</p><p>if you’d like to try it yourself, follow the tutorial from <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-gs.html">AWS official documents</a> to build and manage your EMR clusters and jobs.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-engineering-learning-journey/'>Data Engineering Learning Journey</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >AWS</a> <a href="/tags/data/" class="post-tag no-text-decoration" >data</a> <a href="/tags/lake/" class="post-tag no-text-decoration" >lake</a> <a href="/tags/pipeline/" class="post-tag no-text-decoration" >pipeline</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Run+your+own+Apache+Spark+jobs+in+AWS+EMR+and+S3+-+samueltyh&url=https%3A%2F%2Fsamueltyh.github.io%2Fposts%2Frun-your-own-apache-spark-jobs-in-aws-emr-and-s3%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Run+your+own+Apache+Spark+jobs+in+AWS+EMR+and+S3+-+samueltyh&u=https%3A%2F%2Fsamueltyh.github.io%2Fposts%2Frun-your-own-apache-spark-jobs-in-aws-emr-and-s3%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsamueltyh.github.io%2Fposts%2Frun-your-own-apache-spark-jobs-in-aws-emr-and-s3%2F&text=Run+your+own+Apache+Spark+jobs+in+AWS+EMR+and+S3+-+samueltyh" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/takeaway-unit-testing-of-bash-scripts/">Takeaway: Unit Testing of Bash Scripts</a><li><a href="/posts/learning-and-takeaways-from-kubesimplify-workshop/">Learning and Takeaways from Kubesimplify Workshop</a><li><a href="/posts/setting-both-celery-and-flask-inside-the-docker-compose/">Setting both Celery and Flask inside the docker-compose</a><li><a href="/posts/connect-postgresql-in-docker-container-with-azure-data-studio/">Connect PostgreSQL in docker container with Azure Data Studio</a><li><a href="/posts/how-to-train-a-customized-name-entities-recognition-ner-model-based-on-spacy-pre-trained-model/">How to train a customized Name Entities Recognition (NER) model based on spaCy pre-trained model</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/azure-data-studio/">azure-data-studio</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/celery/">celery</a> <a class="post-tag" href="/tags/cron/">cron</a> <a class="post-tag" href="/tags/data/">data</a> <a class="post-tag" href="/tags/devops/">devops</a> <a class="post-tag" href="/tags/etl/">ETL</a> <a class="post-tag" href="/tags/fivetran/">Fivetran</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/implementing-fivetran-data-source-connector-with-aws-lambda/"><div class="card-body"> <em class="small" data-ts="1653770820" data-df="ll" > May 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Implementing Fivetran Data Source Connector with AWS Lambda</h3><div class="text-muted small"><p> Basic background of AWS Lambda Official developer guide from AWS AWS Lambda is a serverless, event-driven compute service that lets you run code for virtually any type of application or backend s...</p></div></div></a></div><div class="card"> <a href="/posts/setting-both-celery-and-flask-inside-the-docker-compose/"><div class="card-body"> <em class="small" data-ts="1580774400" data-df="ll" > Feb 4, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setting both Celery and Flask inside the docker-compose</h3><div class="text-muted small"><p> Setting both Celery and Flask inside the docker-compose Due to the issue I need to resolve is that put the heavy task to background, then run it periodically or asynchronously. And the most import...</p></div></div></a></div><div class="card"> <a href="/posts/connect-postgresql-in-docker-container-with-azure-data-studio/"><div class="card-body"> <em class="small" data-ts="1580860800" data-df="ll" > Feb 5, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Connect PostgreSQL in docker container with Azure Data Studio</h3><div class="text-muted small"><p> Connect PostgreSQL in docker container with Azure Data Studio Azure Data Studio is a cool product that can easily connect MySQL (if you already installed in your system) and show what in your data...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-train-a-customized-name-entities-recognition-ner-model-based-on-spacy-pre-trained-model/" class="btn btn-outline-primary" prompt="Older"><p>How to train a customized Name Entities Recognition (NER) model based on spaCy pre-trained model</p></a> <a href="/posts/useful-gadget-sharing-cron-job-org/" class="btn btn-outline-primary" prompt="Newer"><p>Useful gadget sharing - cron-job.org</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://samueltyh.github.io/posts/run-your-own-apache-spark-jobs-in-aws-emr-and-s3/'; this.page.identifier = '/posts/run-your-own-apache-spark-jobs-in-aws-emr-and-s3/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://samuelTyh.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/samueltyh">Samuel Tseng</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/azure-data-studio/">azure-data-studio</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/celery/">celery</a> <a class="post-tag" href="/tags/cron/">cron</a> <a class="post-tag" href="/tags/data/">data</a> <a class="post-tag" href="/tags/devops/">devops</a> <a class="post-tag" href="/tags/etl/">ETL</a> <a class="post-tag" href="/tags/fivetran/">Fivetran</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/de.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-7X84VGPKQ1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-7X84VGPKQ1'); }); </script>
